$id: "https://cfdl.dev/ontology/entity/asset.schema.yaml"
$schema: "http://json-schema.org/draft-07/schema#"
title: "Asset"
description: >
  Represents a cash-flowing asset (e.g. a building, property,
  or facility) within a deal.  Assets can have components,
  streams, contracts, and lifecycle state.

type: object

properties:
  id:
    type: string
    format: uri
    description: "Unique identifier for this asset instance."

  name:
    type: string
    description: "Human-readable name of the asset."

  dealId:
    type: string
    format: uri
    description: "Reference to the parent deal (deal.schema.yaml)."

  category:
    type: string
    description: "High-level classification of the asset type."
    enum:
      - real_estate
      - financial_asset
      - physical_asset
      - legal_right
      - operating_entity
      - contract_bundle
      - mixed
      - other

  description:
    type: string
    description: "Long-form description or notes about the asset."

  location:
    type: object
    description: "Geographic and address information."
    properties:
      address:
        type: object
        description: "Structured address components."
        properties:
          street_address:
            type: string
          city:
            type: string
          state:
            type: string
          postal_code:
            type: string
          country:
            type: string
        required: [street_address, city, country]
      latitude:
        type: number
        minimum: -90
        maximum: 90
      longitude:
        type: number
        minimum: -180
        maximum: 180
      timezone:
        type: string
        description: "IANA timezone identifier (e.g. 'America/New_York')."
      market:
        type: string
        description: "Market or submarket designation."

  attributes:
    type: object
    description: "Custom key-value attributes (e.g., sqft, yearBuilt)."
    additionalProperties: true

  components:
    type: array
    description: "Sub-assets or units within this asset."
    items:
      $ref: "https://cfdl.dev/ontology/entity/component.schema.yaml"

  contracts:
    type: array
    description: "Contracts tied to this asset (leases, service agreements)."
    items:
      $ref: "https://cfdl.dev/ontology/entity/contract.schema.yaml"

  streams:
    type: array
    description: "Cash-flow streams defined at the asset level."
    items:
      $ref: "https://cfdl.dev/ontology/behavior/stream.schema.yaml"

  stateConfig:
    type: object
    description: "Lifecycle state machine configuration."
    properties:
      allowedStates:
        type: array
        description: "Valid lifecycle states."
        items:
          type: string
          enum: ["pre_operational", "operational", "non_operational", "disposed"]
      initialState:
        type: string
        description: "State at creation."
        enum: ["pre_operational", "operational"]
      transitionRules:
        type: object
        description: "Valid state transitions."
        additionalProperties:
          type: array
          items:
            type: string
    required: [allowedStates, initialState]

  history:
    type: array
    description: "Chronological record of state changes."
    items:
      type: object
      properties:
        timestamp:
          type: string
          format: date-time
        fromState:
          type: string
        toState:
          type: string
        notes:
          type: string
      required: [timestamp, fromState, toState]

  metadata:
    type: object
    description: "Free-form metadata (tags, UI hints)."
    additionalProperties: true

required:
  - id
  - name
  - dealId
  - category
